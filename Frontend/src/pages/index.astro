---
import Layout from '../layouts/Layout.astro';
import '../styles/style.css'

import { getAllPosts } from '../sanity/api.js';
import { urlForImage} from '../sanity/urlForImage.js';

const posts = await getAllPosts();
---

<div id="mode-switcher" class="mode-switcher" data-theme="light">
	<button id="light-button" class="mode-button active">LIGHT</button>
	<button id="dark-button" class="mode-button">DARK</button>
</div>

<Layout title="IKAMOlog">
	<main class="container">

		<div id="light-mode" class="light-mode">
			<div class="nav-text">
				<div class="nav-text-blocker"></div>
				<div class="nav-text-group">
					<p class="nav-text-title body-title midnight-text-color">A place to document and revisit all aspect of my life.</p>
					<div class="nav-log-logo">
						<p class="nav-text-title body-title">Personal log.</p>
						<div class="nav-body-group">
							<p class="midnight-text-color body">design</p>
							<p class="midnight-text-color body">travel</p>
							<p class="midnight-text-color body">workspace</p>
							<p class="midnight-text-color body">milestone</p>
						</div>
					</div>
				</div>
			</div>

			<h1 class="page-header hero-title midnight-text-color">Select moment.</h1>

			<ul class="log-tiles">
				{posts.map(post => (
					<a href={`/logs/${post.slug.current}`} class="log-tile rounded-40 over">
						<img src={urlForImage(post.thumbnailImage).url()} alt="" class="thumb-image-cover">
						<div class="log-label body midnight-text-color light-gray-color rounded-full">{post.title}</div>
					</a>
				))}
			</ul>
		</div>

		<div id="dark-mode" class="dark-mode">
			<div class="nav-text">
				<div class="nav-text-blocker"></div>
				<div class="nav-text-group">
					<p class="nav-text-title body-title midnight-text-color">A place to document and revisit all aspect of my life.</p>
					<div class="nav-log-logo">
						<p class="nav-text-title body-title midnight-text-color">Personal log.</p>
						<div class="nav-body-group">
							<p class="midnight-text-color body">design</p>
							<p class="midnight-text-color body">travel</p>
							<p class="midnight-text-color body">workspace</p>
							<p class="midnight-text-color body">milestone</p>
						</div>
					</div>
				</div>
			</div>

			<h1 class="page-header hero-title midnight-text-color">Select moment.</h1>

			<ul class="log-tiles-dark">
				{posts.map(post => (
					<a href={`/logs/${post.slug.current}`} class="log-tile-dark over">
						<h1 class="midnight-text-color project-list-title">{post.title}</h1>
					</a>
					<div class="log-separator midnight-color"></div>
				))}
			</ul>
		</div>

	</main>
</Layout>

<script>
	const body = document.getElementById('element');
	const lightButton = document.getElementById('light-button');
	const darkButton = document.getElementById('dark-button');
	const lightWrapper = document.getElementById('light-mode');
	const darkWrapper = document.getElementById('dark-mode');
	const modeSwitcher = document.getElementById('mode-switcher');

	let currentTheme = modeSwitcher.getAttribute('data-theme');


	darkButton.addEventListener('click', () => {
		body.style.backgroundColor = 'rgba(38, 40, 45, 1)';
		lightWrapper.style.opacity= '0';
		darkWrapper.style.opacity= '1';
		darkButton.classList.add('active');
		lightButton.classList.remove('active');
		currentTheme = 'dark';
		localStorage.setItem('theme', currentTheme);
	});

	lightButton.addEventListener('click', () => {
		body.style.backgroundColor = 'rgba(237, 244, 255, 1)'
		darkWrapper.style.opacity= '0';
		lightWrapper.style.opacity= '1';
		lightButton.classList.add('active');
		darkButton.classList.remove('active');
		currentTheme = 'light';
		localStorage.setItem('theme', currentTheme);
	});

	window.addEventListener('DOMContentLoaded', () => {
		const localTheme = localStorage.getItem('theme');
		if (localTheme === 'dark'){
			body.style.backgroundColor = 'rgba(38, 40, 45, 1)';
			lightWrapper.style.opacity= '0';
			darkWrapper.style.opacity= '1';
			darkButton.classList.add('active');
			lightButton.classList.remove('active');
		}
		else{
			body.style.backgroundColor = 'rgba(237, 244, 255, 1)'
			darkWrapper.style.opacity= '0';
			lightWrapper.style.opacity= '1';
			lightButton.classList.add('active');
			darkButton.classList.remove('active');
		}
	});
</script>